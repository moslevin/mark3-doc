<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mark3 Realtime Kernel: /home/moslevin/projects/github/mark3/kernel/src/public/message.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mark3 Realtime Kernel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('message_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<div class="title">message.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Inter-thread communication via message-passing.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="kerneltypes_8h_source.html">kerneltypes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mark3cfg_8h_source.html">mark3cfg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ll_8h_source.html">ll.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ksemaphore_8h_source.html">ksemaphore.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timerlist_8h_source.html">timerlist.h</a>&quot;</code><br />
</div>
<p><a href="message_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mark3_1_1_message.html">Mark3::Message</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mark3_1_1_message_pool.html">Mark3::MessagePool</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_mark3_1_1_message_queue.html">Mark3::MessageQueue</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespace_mark3"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_mark3.html">Mark3</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Inter-thread communication via message-passing. </p>
<p>Embedded systems guru Jack Ganssle once said that without a robust form of interprocess communications (IPC), an RTOS is just a toy. <a class="el" href="namespace_mark3.html">Mark3</a> implements a form of IPC to provide safe and flexible messaging between threads.</p>
<p>using kernel-managed IPC offers significant benefits over other forms of data sharing (i.e. Global variables) in that it avoids synchronization issues and race conditions common to the practice. using IPC also enforces a more disciplined coding style that keeps threads decoupled from one another and minimizes global data, preventing careless and hard-to-debug errors.</p>
<h1><a class="anchor" id="MBCreate"></a>
using Messages, Queues, and the Global Message Pool</h1>
<div class="fragment"><div class="line"><span class="comment">// Declare a message queue shared between two threads</span></div><div class="line">MessageQueue my_queue;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">    ...</div><div class="line">    <span class="comment">// Initialize the message queue</span></div><div class="line">    my_queue.init();</div><div class="line">    ...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Thread1()</div><div class="line">{</div><div class="line">    <span class="comment">// Example TX thread - sends a message every 10ms</span></div><div class="line">    <span class="keywordflow">while</span>(1)</div><div class="line">    {</div><div class="line">        <span class="comment">// Grab a message from the global message pool</span></div><div class="line">        Message *tx_message = GlobalMessagePool::Pop();</div><div class="line"></div><div class="line">        <span class="comment">// Set the message data/parameters</span></div><div class="line">        tx_message-&gt;SetCode( 1234 );</div><div class="line">        tx_message-&gt;SetData( <span class="keyword">nullptr</span> );</div><div class="line"></div><div class="line">        <span class="comment">// Send the message on the queue.</span></div><div class="line">        my_queue.Send( tx_message );</div><div class="line">        Thread::Sleep(10);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Thread2()</div><div class="line">{</div><div class="line">    <span class="keywordflow">while</span>()</div><div class="line">    {</div><div class="line">        <span class="comment">// Blocking receive - wait until we have messages to process</span></div><div class="line">        Message *rx_message = my_queue.Recv();</div><div class="line"></div><div class="line">        <span class="comment">// Do something with the message data...</span></div><div class="line"></div><div class="line">        <span class="comment">// Return back into the pool when done</span></div><div class="line">        GlobalMessagePool::Push(rx_message);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> 
<p class="definition">Definition in file <a class="el" href="message_8h_source.html">message.h</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_3dd30a497388ee684638f120a124721c.html">src</a></li><li class="navelem"><a class="el" href="dir_0c9f3f866ba20950106a72043561edc7.html">public</a></li><li class="navelem"><a class="el" href="message_8h.html">message.h</a></li>
    <li class="footer">Generated on Thu Mar 7 2019 19:45:15 for Mark3 Realtime Kernel by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
